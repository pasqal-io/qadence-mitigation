
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pasqal-io.github.io/qadence-mitigation/latest/v0.0.1/mitigation/readout_mitigation/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../incoherent_error_mitigation/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Readout error mitigation - Qadence Mitigation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#readout-error-mitigation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Qadence Mitigation" class="md-header__button md-logo" aria-label="Qadence Mitigation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Qadence Mitigation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Readout error mitigation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/qadence-mitigation.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence-mitigation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Qadence Mitigation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  Mitigation Methods

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Qadence Mitigation" class="md-nav__button md-logo" aria-label="Qadence Mitigation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Qadence Mitigation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/qadence-mitigation.git" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    qadence-mitigation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qadence Mitigation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Mitigation Methods
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Mitigation Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Readout error mitigation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Readout error mitigation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#constrained-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constrained optimization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maximum-likelihood-estimation-mle" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum Likelihood estimation (MLE)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix-free-measurement-mitigation-mthree" class="md-nav__link">
    <span class="md-ellipsis">
      Matrix free measurement mitigation (MTHREE)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#majority-voting" class="md-nav__link">
    <span class="md-ellipsis">
      Majority Voting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-free-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      Model free mitigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twirl-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      Twirl mitigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../incoherent_error_mitigation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Zero-noise extrapolation for analog blocks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#constrained-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Constrained optimization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maximum-likelihood-estimation-mle" class="md-nav__link">
    <span class="md-ellipsis">
      Maximum Likelihood estimation (MLE)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#matrix-free-measurement-mitigation-mthree" class="md-nav__link">
    <span class="md-ellipsis">
      Matrix free measurement mitigation (MTHREE)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#majority-voting" class="md-nav__link">
    <span class="md-ellipsis">
      Majority Voting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-free-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      Model free mitigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#twirl-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      Twirl mitigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/pasqal-io/qadence-mitigation.git/edit/master/docs/mitigation/readout_mitigation.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/pasqal-io/qadence-mitigation.git/raw/master/docs/mitigation/readout_mitigation.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="readout-error-mitigation">Readout error mitigation</h1>
<p>Readout errors are introduced during measurements in the computation basis via probabilistic bitflip operators characterized by the readout matrix (also known as confusion matrix) defined over the system of qubits of dimension <span class="arithmatex">\(2^n\times2^n\)</span>. The complete implementation of the mitigation technique involves using the characterized readout matrix for the system of qubits <span class="arithmatex">\((T)\)</span> and classically applying an inversion  <span class="arithmatex">\((T^{−1})\)</span> to the measured probability distributions. However there are several limitations of this approach:</p>
<ul>
<li>The complete implementation requires <span class="arithmatex">\(2^n\)</span> characterization experiments (probability measurements), which is not scalable.</li>
<li>Classical overhead from full matrix inversion for large system of qubits is expensive</li>
<li>The matrix <span class="arithmatex">\(T\)</span> may become singular for large <span class="arithmatex">\(n\)</span>, preventing direct inversion.</li>
<li>The inverse <span class="arithmatex">\(T^{−1}\)</span> might not be a stochastic matrix, meaning that it can produce negative corrected probabilities.</li>
<li>The correction is not rigorously justified, so we cannot be sure that we are only removing SPAM errors and not otherwise corrupting an estimated probability distribution.</li>
</ul>
<p>Qadence relies on the assumption of <em>uncorrelated</em> readout errors, this gives us:</p>
<div class="arithmatex">\[
T=T_1\otimes T_2\otimes \dots \otimes T_n
\]</div>
<p>for which the inversion is straightforward:</p>
<div class="arithmatex">\[
T^{-1}=T_1^{-1}\otimes T_2^{-1}\otimes \dots \otimes T_n^{-1}
\]</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumModel</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">hamiltonian_factory</span><span class="p">,</span> <span class="n">kron</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">I</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseProtocol</span><span class="p">,</span> <span class="n">NoiseHandler</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Simple circuit and observable construction.</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">block</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">n_shots</span> <span class="o">=</span> <span class="mi">10000</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Construct a quantum model and noise</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QuantumModel</span><span class="p">(</span><span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">error_probability</span> <span class="o">=</span> <span class="mf">0.2</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseHandler</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">NoiseProtocol</span><span class="o">.</span><span class="n">READOUT</span><span class="o">.</span><span class="n">INDEPENDENT</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error_probability&quot;</span><span class="p">:</span> <span class="n">error_probability</span><span class="p">})</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">noiseless_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">noisy_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">n</span><span class="err">oiseless</span><span class="w"> </span><span class="err">samples</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">OrderedCou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5036</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4964</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kc">n</span><span class="err">oisy</span><span class="w"> </span><span class="err">samples</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">OrderedCou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4562</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4457</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">01</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">11</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">481</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>

</div>
<p>Note that the noisy states have samples with the second qubit flipped. In the below protocols, we describe ways to reconstruct the noiseless distribution (untargeted mitigation). Besides this one might just be interrested in mitigating the expectation value (targeted mitigation).</p>
<div class="admonition warning">
<p class="admonition-title">Mitigation noise</p>
<p>Note it is necessary to pass the <code>noise</code> parameter for the <code>mitigation</code> function because the mitigation process sees <code>QuantumModel</code> as a black box.</p>
</div>
<h2 id="constrained-optimization">Constrained optimization</h2>
<p>However, even for a reduced <span class="arithmatex">\(n\)</span> the forth limitation holds. This can be avoided by reformulating into a minimization problem<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>:</p>
<div class="arithmatex">\[
\lVert Tp_{\textrm{corr}}-p_{\textrm{raw}}\rVert_{2}^{2}
\]</div>
<p>subjected to physicality constraints <span class="arithmatex">\(0 \leq p_{corr}(x) \leq 1\)</span> and <span class="arithmatex">\(\lVert p_{corr} \rVert = 1\)</span>. At this point, two methods are implemented to solve this problem. The method involves solving a constrained optimization problem and can be computationally expensive.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.protocols</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mitigations</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReadOutOptimization</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Define the mitigation method solving the minimization problem:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;optimization_type&quot;</span><span class="p">:</span> <span class="n">ReadOutOptimization</span><span class="o">.</span><span class="n">CONSTRAINED</span><span class="p">,</span> <span class="s2">&quot;n_shots&quot;</span><span class="p">:</span> <span class="n">n_shots</span><span class="p">}</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">mitigation</span> <span class="o">=</span> <span class="n">Mitigations</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">Mitigations</span><span class="o">.</span><span class="n">READOUT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Run noiseless, noisy and mitigated simulations.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">mitigated_samples_opt</span> <span class="o">=</span> <span class="n">mitigation</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Op</span><span class="kc">t</span><span class="err">imiza</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">based</span><span class="w"> </span><span class="err">mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">Cou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5018</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4982</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>

</div>
<h2 id="maximum-likelihood-estimation-mle">Maximum Likelihood estimation (MLE)</h2>
<p>This method replaces the constraints with additional post processing for correcting probability distributions with negative entries. The runtime of the method is linear in the size of the distribution and thus is very efficient. The optimality of the solution is however not always guaranteed. The method redistributes any negative probabilities on using the inverse operation equally and can be shown to maximize the likelihood with minimal effort<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Define the mitigation method solving the minimization problem:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;optimization_type&quot;</span><span class="p">:</span> <span class="n">ReadOutOptimization</span><span class="o">.</span><span class="n">MLE</span><span class="p">,</span> <span class="s2">&quot;n_shots&quot;</span><span class="p">:</span> <span class="n">n_shots</span><span class="p">}</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">mitigation</span> <span class="o">=</span> <span class="n">Mitigations</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">Mitigations</span><span class="o">.</span><span class="n">READOUT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">mitigated_samples_mle</span> <span class="o">=</span> <span class="n">mitigation</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">MLE</span><span class="w"> </span><span class="err">based</span><span class="w"> </span><span class="err">mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="p">[</span><span class="err">Cou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5017</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4946</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">11</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">01</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>

</div>
<h2 id="matrix-free-measurement-mitigation-mthree">Matrix free measurement mitigation (MTHREE)</h2>
<p>This method relies on inverting the probability distribution within a restricted subspace of measured bitstrings<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>. The method is better suited for computations that exceed 20 qubits where the corrected probability distribution would require a state in a unreasonably high dimensional Hilbert space. Thus, the idea here is to stick to the basis states that show up in the measurement alone. Additionally, one might want to include states that are <span class="arithmatex">\(k\)</span> hamming distance away from it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">csr_matrix</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">gmres</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Prepare a probability distribution with sparsity</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">exact_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">n_qubits</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">exact_prob</span><span class="p">[</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n_qubits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">exact_prob</span> <span class="o">=</span> <span class="mf">0.90</span> <span class="o">*</span> <span class="n">exact_prob</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">n_qubits</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">n_qubits</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">exact_prob</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">exact_prob</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">exact_prob</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1"># Create an observed probability distribution with thresholded values</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">observed_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exact_prob</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">observed_prob</span><span class="p">[</span><span class="n">exact_prob</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">n_qubits</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">observed_prob</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">observed_prob</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Convert the observed probability distribution into a sparse matrix</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">input_csr_matrix</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">(</span><span class="n">observed_prob</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">n_qubits</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c1"># Print the binary representation of states with nonzero probabilities</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="nb">print</span><span class="p">({</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="nb">bin</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">):</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">input_csr_matrix</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">input_csr_matrix</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="c1"># Compute and display the percentage of nonzero entries</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">filling_percentage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_csr_matrix</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">n_qubits</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span><span class="err">&#39;</span><span class="mi">0000001100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.048</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0001011111</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.079</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0001110010</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.056</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0010010110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.045</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0011110001</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.034</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0011111101</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0100101111</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.048</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0101011000</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.032</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0101110100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.021</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0101110110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.019</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0110001001</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0111100101</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.054</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1000011011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.03</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1000011110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.011</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1000101001</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.007</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1001011011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.018</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1001011110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.031</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1010000010</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.012</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1010000110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.002</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1010111011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.06</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011000110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.028</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011001100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.052</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011100101</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.006</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011101010</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011101011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.017</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011111000</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.031</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011111100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.036</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1100001111</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.023</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1100101011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.015</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1100111100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.075</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1110101100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.033</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1110110111</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.034</span><span class="p">}</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="err">Filli</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">perce</span><span class="kc">nta</span><span class="err">ge</span><span class="p">:</span><span class="w"> </span><span class="mf">0.031250</span><span class="w"> </span><span class="err">%</span>
</code></pre></div>

</div>
<p>We have constructed a probability distribution over a small subspace of bitstrings, leveraging a <code>csr_matrix</code> for efficient storage and computation. Now, we apply <code>MTHREE</code> to mitigate errors in the probability distribution. Within <code>MTHREE</code>, sparsity can be further improved by incorporating the Hamming distance approach. This method considers only the noise matrix elements corresponding to quantum states within a specified Hamming distance of the correct state. This feature can be used by setting the <code>hamming_dist</code> option.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">wasserstein_distance</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.readout</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">normalized_subspace_kron</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">mle_solve</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">matrix_inv</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="n">tensor_rank_mult</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Generate noise transition matrices for each qubit</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">noise_matrices</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="k">for</span> <span class="n">qubit_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">):</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">transition_prob_a</span><span class="p">,</span> <span class="n">transition_prob_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">transition_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">transition_prob_a</span><span class="p">,</span> <span class="n">transition_prob_a</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>                                  <span class="p">[</span><span class="n">transition_prob_b</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">transition_prob_b</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Ensure column sums to 1</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    <span class="n">noise_matrices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition_matrix</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Compute the subspace confusion matrix using noise transition matrices. We set the hamming distance for filtering out noisy states that are far from the correct state</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">subspace_confusion_matrix</span> <span class="o">=</span> <span class="n">normalized_subspace_kron</span><span class="p">(</span><span class="n">noise_matrices</span><span class="p">,</span> <span class="n">observed_prob</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hamming_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="c1"># Apply GMRES (Generalized Minimal Residual Method) to correct the probability distribution using MTHREE. Then we apply Maximum Likelihood Estimation (MLE) to ensure the validity of the probability distribution.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">corrected_prob_mthree_mle</span> <span class="o">=</span> <span class="n">mle_solve</span><span class="p">(</span><span class="n">gmres</span><span class="p">(</span><span class="n">subspace_confusion_matrix</span><span class="p">,</span> <span class="n">input_csr_matrix</span><span class="o">.</span><span class="n">toarray</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="c1"># Next, we use tensor rank multiplication to apply the inverse noise matrices to the observed probability distribution, followed by the same MLE correction</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="n">inverse_noise_matrices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">matrix_inv</span><span class="p">,</span> <span class="n">noise_matrices</span><span class="p">))</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">corrected_prob_inverse_mle</span> <span class="o">=</span> <span class="n">mle_solve</span><span class="p">(</span><span class="n">tensor_rank_mult</span><span class="p">(</span><span class="n">inverse_noise_matrices</span><span class="p">,</span> <span class="n">observed_prob</span><span class="p">))</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="c1"># Finally, we compute the Wasserstein distance between the two corrected probability distributions</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="n">wasserstein_dist</span> <span class="o">=</span> <span class="n">wasserstein_distance</span><span class="p">(</span><span class="n">corrected_prob_mthree_mle</span><span class="p">,</span> <span class="n">corrected_prob_inverse_mle</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Wassers</span><span class="kc">te</span><span class="err">i</span><span class="kc">n</span><span class="w"> </span><span class="err">dis</span><span class="kc">tan</span><span class="err">ce</span><span class="w"> </span><span class="err">be</span><span class="kc">t</span><span class="err">wee</span><span class="kc">n</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="kc">t</span><span class="err">wo</span><span class="w"> </span><span class="err">dis</span><span class="kc">tr</span><span class="err">ibu</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="p">:</span><span class="w"> </span><span class="mf">9.334464478203815e-05</span>
</code></pre></div>

</div>
<p>In <code>MTHREE</code>, we assume quantum circuits that exceed 20 qubits, which results in a high sparsity in the probability distribution of the output bitstrings, leading to many 0 probability bitstrings. Therefore, we use <code>Wasserstein Distance</code> instead of <code>KL divergence</code> and its derivative, <code>JS divergence</code>, as they put true values (which is 0 here) in the denominator and may diverge in such cases, whereas <code>Wasserstein Distance</code> remains stable for comparisons.</p>
<h2 id="majority-voting">Majority Voting</h2>
<p>Mitigation protocol to be used only when the circuit output has a single expected bitstring as the solution <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>. The method votes on the likeliness of each qubit to be a 0 or 1 assuming a tensor product structure for the output. The method is valid only when the readout errors are not correlated.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumModel</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">,</span><span class="n">kron</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">I</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseHandler</span><span class="p">,</span> <span class="n">NoiseProtocol</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.readout</span><span class="w"> </span><span class="kn">import</span> <span class="n">majority_vote</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Simple circuit and observable construction.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">4</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">block</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">I</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)])</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">n_shots</span> <span class="o">=</span> <span class="mi">1000</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Construct a quantum model.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QuantumModel</span><span class="p">(</span><span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># Sampling the noisy solution</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">error_p</span> <span class="o">=</span> <span class="mf">0.2</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseHandler</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">NoiseProtocol</span><span class="o">.</span><span class="n">READOUT</span><span class="o">.</span><span class="n">INDEPENDENT</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error_probability&quot;</span><span class="p">:</span> <span class="n">error_p</span><span class="p">})</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">noisy_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="c1"># Removing samples that correspond to actual solution</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">noisy_samples</span><span class="p">[</span><span class="s1">&#39;0000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="c1"># Constructing the probability vector</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="n">ordered_bitstrings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n_qubits</span><span class="p">)]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="n">observed_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">noisy_samples</span><span class="p">[</span><span class="n">bs</span><span class="p">]</span> <span class="k">for</span> <span class="n">bs</span> <span class="ow">in</span> <span class="n">ordered_bitstrings</span><span class="p">])</span> <span class="o">/</span> <span class="n">n_shots</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">n</span><span class="err">oisy</span><span class="w"> </span><span class="err">samples</span><span class="p">:</span><span class="w"> </span><span class="err">OrderedCou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">0100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">87</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1000</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0010</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">66</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0001</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">51</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1001</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1100</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1010</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0101</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1101</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1011</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0111</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">1110</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">0000</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="err">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="err">observed</span><span class="w"> </span><span class="err">probabili</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0.</span><span class="w">    </span><span class="mf">0.051</span><span class="w"> </span><span class="mf">0.066</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="mf">0.087</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.005</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.08</span><span class="w">  </span><span class="mf">0.01</span><span class="w">  </span><span class="mf">0.007</span><span class="w"> </span><span class="mf">0.002</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w"> </span><span class="mf">0.008</span><span class="w"> </span><span class="mf">0.004</span><span class="w"> </span><span class="mf">0.001</span><span class="w"> </span><span class="mf">0.</span><span class="w">   </span><span class="p">]</span>
</code></pre></div>

</div>
<p>We have removed the actual solution from the observed distribution and will use this as the observed probability.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">noise_matrices</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">error_p</span><span class="p">,</span> <span class="n">error_p</span><span class="p">],</span> <span class="p">[</span><span class="n">error_p</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">error_p</span><span class="p">]])]</span><span class="o">*</span><span class="n">n_qubits</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">result_index</span> <span class="o">=</span> <span class="n">majority_vote</span><span class="p">(</span><span class="n">noise_matrices</span><span class="p">,</span> <span class="n">observed_prob</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">te</span><span class="err">d</span><span class="w"> </span><span class="err">solu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="err">dex</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div>

</div>
<h2 id="model-free-mitigation">Model free mitigation</h2>
<p>You can perform the mitigation without a <code>quantum model</code> if you have sampled results from previous executions. This eliminates the need to reinitialize the circuit and sample again. Instead, you can directly apply the mitigation method to the existing data. To do this, you need to insert the <code>samples</code> at your <code>options</code> when initializing the <code>Mitigations</code> class.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumModel</span><span class="p">,</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">hamiltonian_factory</span><span class="p">,</span> <span class="n">kron</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">I</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseProtocol</span><span class="p">,</span> <span class="n">NoiseHandler</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.protocols</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mitigations</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ReadOutOptimization</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Simple circuit and observable construction.</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">block</span> <span class="o">=</span> <span class="n">kron</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">I</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">n_shots</span> <span class="o">=</span> <span class="mi">10000</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># Construct a quantum model and noise</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QuantumModel</span><span class="p">(</span><span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">error_probability</span> <span class="o">=</span> <span class="mf">0.2</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseHandler</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">NoiseProtocol</span><span class="o">.</span><span class="n">READOUT</span><span class="o">.</span><span class="n">INDEPENDENT</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error_probability&quot;</span><span class="p">:</span> <span class="n">error_probability</span><span class="p">})</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">noiseless_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">)</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">noisy_samples</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">)</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="c1"># Define the mitigation method with the sample results</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;optimization_type&quot;</span><span class="p">:</span> <span class="n">ReadOutOptimization</span><span class="o">.</span><span class="n">MLE</span><span class="p">,</span> <span class="s2">&quot;n_shots&quot;</span><span class="p">:</span> <span class="n">n_shots</span><span class="p">,</span> <span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="n">noisy_samples</span><span class="p">}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">mitigation</span> <span class="o">=</span> <span class="n">Mitigations</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">Mitigations</span><span class="o">.</span><span class="n">READOUT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="c1"># Run noiseless, noisy and mitigated simulations.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="n">mitigated_samples_opt</span> <span class="o">=</span> <span class="n">mitigation</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Noisy</span><span class="w"> </span><span class="err">samples</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">OrderedCou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4531</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4502</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">01</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">496</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">11</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">471</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="err">Mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">tes</span><span class="w"> </span><span class="err">samples</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">Cou</span><span class="kc">nter</span><span class="err">(</span><span class="p">{</span><span class="err">&#39;</span><span class="mi">10</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">5022</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="mi">00</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="mi">4978</span><span class="p">}</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>

</div>
<h2 id="twirl-mitigation">Twirl mitigation</h2>
<p>This protocol makes use of all possible so-called twirl operations to average out the effect of readout errors into an effective scaling. The twirl operation consists of using bit flip operators before and after the measurement <sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>. The number of twirl operations can be reduced through random sampling with the <code>twirl_samples</code> option. The method is exact in that it requires no calibration which might be prone to modelling errors.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="n">NoiseHandler</span><span class="p">,</span> <span class="n">NoiseProtocol</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.measurements</span><span class="w"> </span><span class="kn">import</span> <span class="n">Measurements</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence.operations</span><span class="w"> </span><span class="kn">import</span> <span class="n">CNOT</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">Z</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence_mitigation.protocols</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mitigations</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">qadence</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">QuantumCircuit</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="n">QuantumModel</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">chain</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="n">kron</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">)</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">error_probability</span><span class="o">=</span><span class="mf">0.15</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">n_shots</span><span class="o">=</span><span class="mi">10000</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">block</span><span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">kron</span><span class="p">(</span><span class="n">RX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="n">RX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">)),</span> <span class="n">CNOT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">observable</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span> <span class="o">*</span> <span class="n">kron</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">circuit</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">noise</span> <span class="o">=</span> <span class="n">NoiseHandler</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">NoiseProtocol</span><span class="o">.</span><span class="n">READOUT</span><span class="o">.</span><span class="n">INDEPENDENT</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error_probability&quot;</span><span class="p">:</span> <span class="n">error_probability</span><span class="p">})</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="n">tomo_measurement</span> <span class="o">=</span> <span class="n">Measurements</span><span class="p">(</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>    <span class="n">protocol</span><span class="o">=</span><span class="n">Measurements</span><span class="o">.</span><span class="n">TOMOGRAPHY</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;n_shots&quot;</span><span class="p">:</span> <span class="n">n_shots</span><span class="p">},</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="p">)</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="n">model</span> <span class="o">=</span> <span class="n">QuantumModel</span><span class="p">(</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="n">noisy_model</span> <span class="o">=</span> <span class="n">QuantumModel</span><span class="p">(</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="n">measurement</span><span class="o">=</span><span class="n">tomo_measurement</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="n">mitigate</span> <span class="o">=</span> <span class="n">Mitigations</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">Mitigations</span><span class="o">.</span><span class="n">TWIRL</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">expectation_mitigated</span> <span class="o">=</span> <span class="n">mitigate</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">noisy_model</span><span class="p">)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="c1"># We set a number of qubits as the sample count. The number of twirl_samples can range from 1 to the maximum number of qubit index combinations. For example, using a higher number of samples can improve accuracy.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;twirl_samples&quot;</span><span class="p">:</span> <span class="n">block</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="n">mitigate_sample</span> <span class="o">=</span> <span class="n">Mitigations</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">Mitigations</span><span class="o">.</span><span class="n">TWIRL</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="n">expectation_mitigated_sample</span> <span class="o">=</span> <span class="n">mitigate_sample</span><span class="p">(</span><span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">noisy_model</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kc">n</span><span class="err">oiseless</span><span class="w"> </span><span class="err">expec</span><span class="kc">tat</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">3.6060</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Tra</span><span class="kc">ns</span><span class="err">poseBackward</span><span class="mi">0</span><span class="err">&gt;)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kc">n</span><span class="err">oisy</span><span class="w"> </span><span class="err">expec</span><span class="kc">tat</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[[</span><span class="mf">2.7726</span><span class="p">]],</span><span class="w"> </span><span class="err">grad_</span><span class="kc">fn</span><span class="err">=&lt;Tra</span><span class="kc">ns</span><span class="err">poseBackward</span><span class="mi">0</span><span class="err">&gt;)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="err">expec</span><span class="kc">te</span><span class="err">d</span><span class="w"> </span><span class="err">mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">3.6224</span><span class="p">]</span><span class="err">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="err">expec</span><span class="kc">te</span><span class="err">d</span><span class="w"> </span><span class="err">sampled</span><span class="w"> </span><span class="err">mi</span><span class="kc">t</span><span class="err">iga</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">3.6268</span><span class="p">]</span><span class="err">)</span>
</code></pre></div>

</div>
<h2 id="references">References</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="https://arxiv.org/abs/2001.09980">Michael R. Geller and Mingyu Sun, Efficient correction of multiqubit measurement errors, (2020)</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://arxiv.org/abs/1106.5458">Smolin <em>et al.</em>, Maximum Likelihood, Minimum Effort, (2011)</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p><a href="https://arxiv.org/pdf/2108.12518">Gambetta <em>et al.</em>: Scalable mitigation of measurement errors on quantum computers</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p><a href="https://arxiv.org/pdf/2402.11830">Dror Baron <em>et al.</em>: Maximum Likelihood Quantum Error Mitigation for Algorithms with a Single Correct Output</a>&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p><a href="https://arxiv.org/pdf/2012.09738">Kristan Temme <em>et al.</em> : Model-free readout-error mitigation for quantum expectation values </a>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.action.view", "content.action.edit", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>